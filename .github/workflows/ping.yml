name: üöÄ Ping Render Bot
on:
  # –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
  schedule:
    - cron: '*/5 * * * *'
  
  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ GitHub
  workflow_dispatch:
  
  # –ó–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ main –≤–µ—Ç–∫—É (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
  push:
    branches: [ main ]

jobs:
  ping-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      # –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥
      - name: üì¶ Checkout code
        uses: actions/checkout@v3
        
      # –®–∞–≥ 2: –ü–∏–Ω–≥–æ–≤–∞—Ç—å –±–æ—Ç–∞
      - name: üì° Ping ASinglePoint Bot
        run: |
          echo "üïê –ù–∞—á–∏–Ω–∞—é –ø–∏–Ω–≥ –±–æ—Ç–∞..."
          echo "URL: https://asinglepoint-bot.onrender.com/health"
          
          # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          STATUS_CODE=$(curl -s -o /dev/null -w "%{http_code}" \
            "https://asinglepoint-bot.onrender.com/health" \
            --max-time 30)
          
          # –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è
          CURRENT_TIME=$(date '+%Y-%m-%d %H:%M:%S')
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç
          if [ "$STATUS_CODE" -eq 200 ]; then
            echo "‚úÖ $CURRENT_TIME - –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç! –ö–æ–¥: $STATUS_CODE"
            echo "SUCCESS=true" >> $GITHUB_ENV
          else
            echo "‚ùå $CURRENT_TIME - –û—à–∏–±–∫–∞! –ö–æ–¥: $STATUS_CODE"
            echo "SUCCESS=false" >> $GITHUB_ENV
            exit 1
          fi
          
      # –®–∞–≥ 3: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è)
      - name: üìä –ó–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if: always()
        run: |
          echo "--- üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê ---"
          echo "–í—Ä–µ–º—è: $(date)"
          echo "–†–∞–±–æ—á–∞—è –≤–µ—Ç–∫–∞: ${{ github.ref }}"
          echo "–ó–∞–ø—É—â–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ–º: ${{ github.event_name }}"
          echo "---------------------"
